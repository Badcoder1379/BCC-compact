@{
    ViewBag.Title = "Home Page";
}

<!DOCTYPE html>
<html>

<head>


    <TITLE>MMD compacter</TITLE>
    <style>
        .fullScreenStyle {
            position: center;
            height: 100%;
            width: 100%;
            min-height: 100%;
            min-width: 100%;
            padding: 10px;
            border: 2px solid green;
            background-color: aquamarine;
            margin-top: 10px;
            border-radius: 10px;
        }

        .textInputStyle {
            font-size: 10px;
            border: 2px solid green;
            border-radius: 5px;
            color: darkslateblue;
            font-family: 'Comic Sans MS';
            margin-left: 10px;
            background-color: azure;
        }

        .buttonStyle {
            background-color: darkslateblue;
            color: aquamarine;
            margin-left: 150px;
            text-align: center;
            font-family: 'Comic Sans MS';
            font-size: 15px;
            padding-right: 50px;
            padding-left: 50px;
            border: 3px solid darkblue;
            border-radius: 7px;
        }



        .containerStyle {
            margin-top: 20px;
            background-color: lightcyan;
            border: 1px solid darkslateblue;
            border-radius: 5px;
            height: 700px;
            width: 100%;
        }

        .textStyle {
            color: darkslateblue;
            font-size: 15px;
            font-family: 'Comic Sans MS';
        }

        .randomTextStyle {
            font-size: 10px;
            border: 2px solid green;
            border-radius: 5px;
            color: darkslateblue;
            font-family: 'Comic Sans MS';
            margin-right: 50px;
            background-color: azure;
        }

        .randomButtonStyle {
            margin-top: 10px;
            background-color: darkslateblue;
            color: aquamarine;
            text-align: center;
            font-family: 'Comic Sans MS';
            font-size: 15px;
            padding-right: 20px;
            padding-left: 20px;
            border: 3px solid darkblue;
            border-radius: 7px;
            margin-left: 50px;
        }
    </style>

</head>



<body>

    <div class="fullScreenStyle">
        <form>
            <strong style="color :darkslateblue;align-content : center; font-size : 20px; font-family :  'Comic Sans MS';">
                Graph Compacter
            </strong>
            <br />
            <strong style="color : darkslateblue; font-size : 15px; font-family :  'Comic Sans MS';"> input your graph file name : </strong>
            <input type="text" class="textInputStyle" value="test1.txt" id="text" />
            <input type="button" class="buttonStyle" value="compact" onclick="compact()" />
            <input type="button" class="buttonStyle" value="update list" onclick="updateList()" />
            <br />
            <ul id='files-list' >
            </ul>
        </form>
    </div>
    <div class="fullScreenStyle">
        <form>
            <strong class="textStyle"> number of vertices : </strong>
            <input type="text" class="randomTextStyle" value="10" id="V" />
            <strong class="textStyle"> number of edges : </strong>
            <input type="text" class="randomTextStyle" value="20" id="E" />
            <strong class="textStyle"> fileName : </strong>
            <input type="text" class="randomTextStyle" value="random.txt" id="randomGraph-fileName" />
            <br />
            <input type="button" class="randomButtonStyle" value="random graph compact" onclick="randomGraphCompact()" />
            <input type="button" class="randomButtonStyle" value="random graph" onclick="drawRandomGraph()" />

        </form>
    </div>
    <div id="graph-container" class="containerStyle">
    </div>


</body>
</html>



















<script>
    function updateList() {
        var text = "";
        $.ajax({
            url: '/query/getFiles',
            method: 'post',
            data: null
        }).done((result) => {
            $.each(result, (index, value) => {
                text += "<li>" + value + "</li>";
            });
        });
        $('#files-list').html(text);
        getElementsByTagName("ul")[0].innerHTML = text;
    }
    updateList();
</script>




<script src="~/Scripts/ogma.min.js"></script>

@section scripts{
    <script>
        function compact() {
            const queryText = $('#text').val();
            $.ajax({
                url: '/query/compact',
                method: 'post',
                data: { query: queryText }
            }).done((result) => {
                drawGraph(result);
            });
        }

        function randomGraphCompact() {

            const v = $('#V').val();
            const e = $('#E').val();
            const fileName = $('#randomGraph-fileName').val();

            var queryText = v + "-" + e + "-" + fileName;
            $.ajax({
                url: '/query/randomGraph',
                method: 'post',
                data: { query: queryText }
            }).done((result) => {
                drawGraph(result);
            });
        }

        function drawGraph(result) {
            var g = { nodes: [], edges: [] };
            $.each(result.Locations, (index, value) => {
                g.nodes.push({
                    id: 'n' + index,
                    attributes: {
                        x: value.X,
                        y: value.Y,
                        text: 'N' + index,
                        radius: 10
                    }
                });
            });
            $.each(result.Edges, (index, value) => {
                g.edges.push({
                    id: 'e' + index,
                    source: 'n' + value.A,
                    target: 'n' + value.B,
                    attributes: { text: 'edge' + index }
                });
            });
            $('#text').html('');
            var ogma = new Ogma({
                graph: g,
                container: 'graph-container'
            });
        }

    </script>
}




<script>
    function drawRandomGraph() {
        var element = document.getElementById('graph-container');
        var positionInfo = element.getBoundingClientRect();
        var height = positionInfo.height;
        var width = positionInfo.width;
        var v = $('#V').val();
        var e = $('#E').val();
        v = parseInt(v);
        e = parseInt(e);
        function randomGraph(N, E) {
            var g = { nodes: [], edges: [] };
            for (var i = 0; i < N; i++) {
                g.nodes.push({
                    id: 'n' + i,
                    attributes: {
                        x: Math.random() * width,
                        y: Math.random() * height,
                        text: 'n' + i,
                        radius: 100
                    }
                });
            }
            for (var i = 0; i < E; i++) {
                g.edges.push({
                    id: 'e' + i,
                    source: 'n' + (Math.random() * N | 0),
                    target: 'n' + (Math.random() * N | 0),
                    attributes: { text: 'edge' + i }
                });
            }
            return g;
        }
        var g = randomGraph(v, e);
        var ogma = new Ogma({
            graph: g,
            container: 'graph-container'
        });
    }


</script>
